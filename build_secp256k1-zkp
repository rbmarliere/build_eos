#!/usr/bin/env zsh

WD=$USER_GIT_ROOT/secp256k1-zkp
if [[ ! -d $WD ]]; then
    git clone git@github.com:cryptonomex/secp256k1-zkp.git $WD
fi

cd $WD
[[ $YES -eq 0 ]] && read REPLY"?clean $WD? [y|N] "
if [[ $YES -eq 1 || $REPLY =~ ^[Yy]$ ]]; then
    git clean -fdx
fi

./autogen.sh
./configure --prefix=$WD/release
gmake -j${NPROC:-1} install

